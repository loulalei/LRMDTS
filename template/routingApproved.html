{{template "header" .}}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.8-beta.17/jquery.inputmask.min.js"
    integrity="sha512-zdfH1XdRONkxXKLQxCI2Ak3c9wNymTiPh5cU4OsUavFDATDbUzLR+SYWWz0RkhDmBDT0gNSUe4xrQXx8D89JIQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<input type="text" id="baseURL" value="{{.baseURL}}" readonly hidden>
<nav class="navbar navbar-expand-sm bg-body-tertiary">
    <div class="container-fluid">
        <a class="navbar-brand" href="#"><i class="bi bi-calendar-week"></i> DOCUMENT - APPROVED</a>
    </div>
</nav>

<div class="container-fluid py-2 shadow mb-3">
    <!-- RECEIVING -->
    <div class="row">
        {{range .viewRoutings}}
        <span class="badge bg-secondary my-2 fw-bold">RECEIVING - Encoder: <i>{{.Encoder}}</i></span>
        <div class="col-md-4">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="trackingNumberx" name="trackingNumberx"
                    value="{{ .TrackingNumber}}" disabled>
                <label for="trackingNumberx">Tracking Number</label>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="receivedDate" name="receivedDate" value="{{.ReceivedDate}}"
                    disabled>
                <label for="receivedDate">Date</label>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="receivedTime" name="receivedTime" value="{{.ReceivedTime}}"
                    disabled>
                <label for="receivedTime">Time</label>
            </div>
        </div>
        <div class="col-md-4">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="receiver" name="receiver" value="{{.Receiver}}" disabled>
                <label for="receiver">Receiver</label>
            </div>
        </div>
        <div class="col-md-8">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="summary" name="summary" value="{{.Summary}}" disabled>
                <label for="summary">Summary</label>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="recevingDocumentTag" name="recevingDocumentTag"
                    value="{{.DocumentTag}}" disabled>
                <label for="recevingDocumentTag">Document Tag</label>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="receivingRemarks" name="receivingRemarks"
                    value="{{.Remarks}}" disabled>
                <label for="receivingRemarks">Receiving Remarks</label>
            </div>
        </div>
        <div class="col-md-8">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="receivedFile" name="receivedFile" value="{{.ReceivedFile}}"
                    disabled>
                <label for="receivedFile">Received File</label>
            </div>
        </div>
    </div>
    {{end}}
    <!-- FOR AGENDA -->
    <div class="row">
        {{ range .viewAgenda}}
        {{if .ModifiedBy}}
        <span class="badge bg-secondary my-2 fw-bold">AGENDA - Encoder: <i>{{.Encoder}}</i> | Modified By:
            <i>{{.ModifiedBy}}</i></span>
        {{else}}
        <span class="badge bg-secondary my-2 fw-bold">AGENDA - Encoder: <i>{{.Encoder}}</i></span>
        {{end}}

        <div class="col-md-2">
            <div class="form-floating mb-3">
                {{if .IsUrgent}}
                <input type="text" class="form-control" id="receivedDate" name="receivedDate" value="Yes" disabled>
                {{else}}
                <input type="text" class="form-control" id="receivedDate" name="receivedDate" value="No" disabled>
                {{end}}
                <label for="receivedDate">Is this document URGENT?</label>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="ItemNumber" name="ItemNumber" value="{{.ItemNumber}}"
                    disabled>
                <label for="ItemNumber">Item Number</label>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="dateCalendared" name="dateCalendared"
                    value="{{.DateCalendared}}" disabled>
                <label for="dateCalendared">Date Calendared</label>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="dateReported" name="dateReported" value="{{.DateReported}}"
                    disabled>
                <label for="dateReported">Date Reported</label>
            </div>
        </div>
        <div class="col-md-4">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="source" name="source" value="{{.SourceResult}}" disabled>
                <label for="source">Source</label>
            </div>
        </div>
        {{end}}
        <div class="col-md-8">
            <table class="table table-striped table-hover border">
                <thead>
                    <tr>
                        <th colspan="2">COMMITTEE LIST</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .itemCommittees}}
                    <tr>
                        <td>{{.Name}}</td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{ range .viewAgenda}}
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="documentTag" name="documentTag" value="{{.AgendaTag}}"
                    disabled>
                <label for="soudocumentTagrce">Document Tag</label>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="remarks" name="remarks" value="{{.AgendaRemarks}}" disabled>
                <label for="remarks">Remarks</label>
            </div>
        </div>
        {{end}}
    </div>
    <!-- APRROVED -->
    <form class="row" action="/api/routing/register_approved" method="post" enctype="multipart/form-data" id="approved"
        name="approved" autocomplete="off">
        <input type="text" id="docId" name="docId" value="{{.docId}}" hidden readonly>
        <input type="text" id="itemNumber" name="itemNumber" value="{{.itemNumber}}" hidden readonly>
        <span class="badge bg-secondary my-2 fw-bold">APPROVED</span>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <select class="form-select" id="lawType" name="lawType" required>
                    <option selected disabled>Select</option>
                    <option value="1">Ordinance</option>
                    <option value="1">Resolution</option>
                </select>
                <label for="lawType">Legislative Measure</label>
            </div>
        </div>
        <div class="col-md-1">
            <div class="form-floating mb-2">
                <input type="text" class="form-control" id="lawNumber" name="lawNumber" required>
                <label for="lawNumber">No.</label>
            </div>
        </div>
        <div class="col-md-1">
            <div class="form-floating mb-2">
                <input type="text" class="form-control" id="series" name="series" required>
                <label for="series">Series</label>
            </div>
        </div>
        <div class="col-md-2">
            <div class="form-floating mb-3">
                <input type="date" class="form-control" id="enactedDate" name="enactedDate" required>
                <label for="enactedDate">Date Enacted</label>
            </div>
        </div>
        <div class="col-md-6">
            <div class="mb-12">
                <label for="receiving_file" class="form-label">Attach Res/Ord File</label>
                <input class="form-control form-control-sm" id="attachedFile" name="attachedFile" type="file"
                    accept="application/pdf" required>
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-floating mb-3">
                <select class="form-select" id="motionedBy" name="motionedBy" required>
                    <option selected disabled>Select</option>
                    {{ range .proponents}}
                    <option value="{{.Name}}">{{.Name}}</option>
                    {{end}}
                </select>
                <label for="motionedBy">Motioned By</label>
            </div>
            <div class="form-floating mb-3">
                <select class="form-select" id="author" name="author" required>
                    <option selected disabled>Select</option>
                    {{ range .proponents}}
                    <option value="{{.Name}}">{{.Name}}</option>
                    {{end}}
                </select>
                <label for="author">Author</label>
            </div>
        </div>
        <div class="col-md-9">
            <div class="form-floating mb-3">
                <textarea class="form-control" id="titleBody" name="titleBody" style="height: 132px"
                    required></textarea>
                <label for="titleBody">Title/Body</label>
            </div>
        </div>
        <hr>
        <div class="col-md-12 mb-2">
            <small><button id="submitBtn" name="submitBtn" class="btn btn-success fw-bold btn-sm" type="button"><i
                        class="fa-solid fa-floppy-disk"></i> SAVE
                    DOCUMENT</button></small>
        </div>
    </form>
</div>

<script>
    $(document).ready(function () {
        $("#submitBtn").click(function () {
            Swal.fire({
                title: "Do you want to save this record?",
                icon: "question",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Save"
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    $("#approved").submit(); // Submit the form
                } else if (result.isDenied) {
                    Swal.fire("Cancel saving record", "", "info");
                }
            });
        });
        $("#lawNumber").inputmask("9999");
        $("#series").inputmask("9999");
    });
</script>